# Memory Tools Service Configuration

# Service settings
service:
  name: memory-tools
  port: 8090
  log_level: info
  log_format: json

# Database configuration
database:
  url: postgres://jan_user:password@postgres:5432/jan_memory?sslmode=disable
  max_connections: 50
  max_idle_connections: 10
  connection_max_lifetime: 30m

# Embedding service configuration
embedding:
  base_url: http://bge-m3-service:8091
  api_key: ""
  timeout: 30s
  validate_on_startup: true
  expected_model: BAAI/bge-m3
  expected_dimension: 1024
  
  # Retry configuration
  retry:
    enabled: true
    max_attempts: 3
    initial_backoff: 1s
    max_backoff: 10s
  
  # Cache configuration
  cache:
    enabled: true
    type: redis  # redis, memory, noop
    
    redis:
      url: redis://redis:6379/3
      key_prefix: "emb:"
      ttl: 1h
    
    memory:
      max_size: 10000
      ttl: 1h
  
  # Batch processing
  batch:
    enabled: true
    max_size: 32
    timeout: 5s
  
  # Circuit breaker
  circuit_breaker:
    enabled: true
    threshold: 5
    timeout: 30s
    max_concurrent: 100

# Memory configuration
memory:
  # Search settings
  search:
    default_limit: 20
    min_similarity: 0.5
    max_user_items: 20
    max_project_items: 20
    max_episodic_items: 20
  
  # Ranking weights
  ranking:
    dense_weight: 0.7
    sparse_weight: 0.2
    lexical_weight: 0.1
  
  # Episodic memory retention
  episodic:
    retention_days: 14
    max_events_per_user: 1000

# API settings
api:
  timeout: 30s
  max_request_size: 10MB
  enable_auth: false
  api_key: ""
