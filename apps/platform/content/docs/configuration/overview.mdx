---
title: Configuration Overview
description: Understanding Jan Server configuration system
full: false
---

# Configuration Overview

Jan Server ships with a centralized configuration system shared by Docker Compose, `jan-cli`, and the Kubernetes Helm chart. Every service reads from the same type-safe Go structs so defaults stay in sync across environments.

## Why This Matters

- **Safe**: Config validation runs before services start, preventing misconfigured deployments.
- **Clear**: Defaults live in version control, so teams can see every available knob.
- **Flexible**: YAML files, `.env`, and real environment variables stack cleanly.
- **Testable**: `jan-cli config` exposes validation, diff, and export commands for CI/CD pipelines.

## Loading Order

Configuration is merged in this order (later overrides earlier):

1. Struct defaults compiled from `pkg/config/types.go`.
2. `config/defaults.yaml` (generated from the structs).
3. Optional `config/environments/<env>.yaml` overlays (per environment).
4. `.env` and `config/secrets.env` created by `make quickstart` or `make setup`.
5. Real environment variables provided by Docker/Kubernetes/CI (highest priority).

## Quick Commands

```bash
# Validate merged configuration
jan-cli config validate

# Inspect a specific service
jan-cli config show services.llm-api

# Export full config as YAML or env vars
jan-cli config export --format yaml
jan-cli config export --format env > config/generated.env

# Convenience Make targets
make config-validate
make config-show
make config-export
```

## Documentation Map

| Doc | Purpose |
|-----|---------|
| [Environment Variables](/docs/configuration/environment-variables) | Complete env var reference with mappings. |
| [Docker Compose Configuration](/docs/configuration/docker-compose) | How Compose profiles consume config values. |
| [Kubernetes Configuration](/docs/configuration/kubernetes) | Mapping between config and Helm values. |
| [Getting Started Configuration](/docs/getting-started/configuration) | Step-by-step walkthrough for new installs. |

## Configuration Files

### `.env` (primary settings)

Generated by `make quickstart` or copied from `.env.template`:

```bash
ENVIRONMENT=development
COMPOSE_PROFILES=infra,api,mcp
KONG_HTTP_PORT=8000
LLM_API_HTTP_PORT=8080
RESPONSE_API_HTTP_PORT=8082
MCP_TOOLS_HTTP_PORT=8091
MEDIA_API_HTTP_PORT=8285
LLM_PROVIDER=vllm
VLLM_PORT=8101
```

### `config/secrets.env` (sensitive values)

Git-ignored file that mirrors `config/secrets.env.example`:

```bash
HF_TOKEN=hf_xxxxxxxxxxxxx
OPENAI_API_KEY=sk-xxxxxxxxxxxxx
ANTHROPIC_API_KEY=sk-ant-xxxxxxxxxxxxx
SERPER_API_KEY=xxxxxxxxxxxxx
POSTGRES_PASSWORD=supersecret
AWS_ACCESS_KEY_ID=AKIA...
AWS_SECRET_ACCESS_KEY=...
```

### `config/defaults.yaml`

Version-controlled defaults generated from Go structs:

```yaml
environment: development
services:
  llm-api:
    http:
      port: 8080
      timeout: 30s
    database:
      dsn: postgres://jan_user:jan_password@api-db:5432/jan_llm_api
      max_idle_conns: 10
      max_open_conns: 30
    auth:
      enabled: true
      issuer: http://localhost:8085/realms/jan
```

### `config/environments/<env>.yaml`

Optional overlays you create per environment. Example `config/environments/production.yaml`:

```yaml
environment: production
services:
  llm-api:
    http:
      timeout: 60s
    database:
      max_idle_conns: 20
      max_open_conns: 100
    observability:
      enabled: true
      endpoint: https://otel-collector.prod.example.com
```

## Environment Variable Overrides

Environment variables win last and use predictable prefixes:

```bash
# Override HTTP port
export LLM_API_HTTP_PORT=9090

# Point to managed database
export POSTGRES_HOST=my-prod-db.example.com
export POSTGRES_USER=jan_prod
export POSTGRES_PASSWORD=$(aws secretsmanager get-secret-value ...)

# Enable observability stack
export OTEL_ENABLED=true
export OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
```

## Validation & Troubleshooting

```bash
# Confirm Docker Compose sees the same values
docker compose config | rg LLM_API_HTTP_PORT -n

# Check for missing keys
jan-cli config validate --strict

# Compare local changes against defaults
jan-cli config drift  # via Makefile target
```

If configuration fails to load:

1. Run `make config-validate` to see schema errors.
2. Ensure `.env` and `config/secrets.env` exist (rerun `make quickstart` if needed).
3. Inspect exported YAML (`jan-cli config export --format yaml`) for unexpected values.

Need deeper dives? Continue with the focused configuration docs listed above.
