{"$schema":"1.0.0","$id":"https://github.com/janhq/jan-server/packages/go-common/config/config","$defs":{"APIKeyConfig":{"properties":{"prefix":{"type":"string"},"default_ttl":{"type":"integer"},"max_ttl":{"type":"integer"},"max_per_user":{"type":"integer","minimum":1}},"additionalProperties":false,"type":"object","required":["prefix","default_ttl","max_ttl","max_per_user"]},"AuthConfig":{"properties":{"keycloak":{"$ref":"#/$defs/KeycloakConfig"}},"additionalProperties":false,"type":"object","required":["keycloak"]},"BatchConfig":{"properties":{"enabled":{"type":"boolean"},"max_size":{"type":"integer","minimum":1},"timeout":{"type":"integer"}},"additionalProperties":false,"type":"object","required":["enabled","max_size","timeout"]},"CacheConfig":{"properties":{"enabled":{"type":"boolean"},"type":{"type":"string","enum":["redis","memory","noop"]},"redis":{"$ref":"#/$defs/RedisCacheConfig"},"memory":{"$ref":"#/$defs/MemoryCacheConfig"}},"additionalProperties":false,"type":"object","required":["enabled","type","redis","memory"]},"CircuitBreakerConfig":{"properties":{"enabled":{"type":"boolean"},"threshold":{"type":"integer","minimum":1},"timeout":{"type":"integer"},"max_concurrent":{"type":"integer","minimum":1}},"additionalProperties":false,"type":"object","required":["enabled","threshold","timeout","max_concurrent"]},"DatabaseConfig":{"properties":{"postgres":{"$ref":"#/$defs/PostgresConfig"}},"additionalProperties":false,"type":"object","required":["postgres"]},"EmbeddingConfig":{"properties":{"base_url":{"type":"string","format":"uri"},"api_key":{"type":"string"},"timeout":{"type":"integer"},"validate_on_startup":{"type":"boolean"},"expected_model":{"type":"string"},"expected_dimension":{"type":"integer","minimum":1},"retry":{"$ref":"#/$defs/RetryConfig"},"cache":{"$ref":"#/$defs/CacheConfig"},"batch":{"$ref":"#/$defs/BatchConfig"},"circuit_breaker":{"$ref":"#/$defs/CircuitBreakerConfig"}},"additionalProperties":false,"type":"object","required":["base_url","timeout","validate_on_startup","expected_model","expected_dimension","retry","cache","batch","circuit_breaker"]},"GatewayConfig":{"properties":{"kong":{"$ref":"#/$defs/KongConfig"}},"additionalProperties":false,"type":"object","required":["kong"]},"GrafanaConfig":{"properties":{"port":{"type":"integer","maximum":65535,"minimum":1},"admin_user":{"type":"string"},"admin_password":{"type":"string"}},"additionalProperties":false,"type":"object","required":["port","admin_user"]},"InferenceConfig":{"properties":{"vllm":{"$ref":"#/$defs/VLLMConfig"}},"additionalProperties":false,"type":"object","required":["vllm"]},"InfrastructureConfig":{"properties":{"database":{"$ref":"#/$defs/DatabaseConfig"},"auth":{"$ref":"#/$defs/AuthConfig"},"gateway":{"$ref":"#/$defs/GatewayConfig"}},"additionalProperties":false,"type":"object","required":["database","auth","gateway"]},"JaegerConfig":{"properties":{"ui_port":{"type":"integer","maximum":65535,"minimum":1}},"additionalProperties":false,"type":"object","required":["ui_port"]},"KeycloakConfig":{"properties":{"base_url":{"type":"string","format":"uri"},"public_url":{"type":"string","format":"uri"},"realm":{"type":"string"},"http_port":{"type":"integer","maximum":65535,"minimum":1},"admin_user":{"type":"string"},"admin_password":{"type":"string"},"admin_realm":{"type":"string"},"admin_client_id":{"type":"string"},"backend_client_id":{"type":"string"},"backend_client_secret":{"type":"string"},"client":{"type":"string"},"oauth_redirect_uri":{"type":"string","format":"uri"},"jwks_url":{"type":"string","format":"uri"},"oidc_discovery_url":{"type":"string","format":"uri"},"issuer":{"type":"string","format":"uri"},"account":{"type":"string"},"refresh_jwks_interval":{"type":"integer"},"auth_clock_skew":{"type":"integer"},"guest_role":{"type":"string"},"features":{"items":{"type":"string"},"type":"array"}},"additionalProperties":false,"type":"object","required":["base_url","public_url","realm","http_port","admin_user","admin_password","admin_realm","admin_client_id","backend_client_id","backend_client_secret","client","oauth_redirect_uri","jwks_url","oidc_discovery_url","issuer","account","refresh_jwks_interval","auth_clock_skew","guest_role","features"]},"KongConfig":{"properties":{"http_port":{"type":"integer","maximum":65535,"minimum":1},"admin_port":{"type":"integer","maximum":65535,"minimum":1},"admin_url":{"type":"string","format":"uri"},"log_level":{"type":"string","enum":["debug","info","warn","error"]}},"additionalProperties":false,"type":"object","required":["http_port","admin_port","admin_url","log_level"]},"LLMAPIConfig":{"properties":{"http_port":{"type":"integer","maximum":65535,"minimum":1},"metrics_port":{"type":"integer","maximum":65535,"minimum":1},"log_level":{"type":"string","enum":["debug","info","warn","error"]},"log_format":{"type":"string","enum":["json","console"]},"auto_migrate":{"type":"boolean"},"provider_config_file":{"type":"string"},"provider_config_set":{"type":"string"},"provider_configs_enabled":{"type":"boolean"},"api_key":{"$ref":"#/$defs/APIKeyConfig"},"model_provider_secret":{"type":"string"},"model_sync_enabled":{"type":"boolean"},"model_sync_interval_minutes":{"type":"integer","minimum":1},"prompt_orchestration":{"$ref":"#/$defs/PromptOrchestrationConfig"},"media_resolve_url":{"type":"string","format":"uri"},"media_resolve_timeout":{"type":"integer"}},"additionalProperties":false,"type":"object","required":["http_port","metrics_port","log_level","log_format","auto_migrate","provider_config_file","provider_config_set","provider_configs_enabled","api_key","model_sync_enabled","model_sync_interval_minutes","prompt_orchestration","media_resolve_url","media_resolve_timeout"]},"MCPToolsConfig":{"properties":{"http_port":{"type":"integer","maximum":65535,"minimum":1},"log_level":{"type":"string","enum":["debug","info","warn","error"]},"log_format":{"type":"string","enum":["json","console"]},"search_engine":{"type":"string","enum":["serper","exa","tavily","searxng"]},"serper_api_key":{"type":"string"},"serper_enabled":{"type":"boolean"},"exa_api_key":{"type":"string"},"exa_enabled":{"type":"boolean"},"exa_search_endpoint":{"type":"string"},"exa_timeout":{"type":"integer"},"tavily_api_key":{"type":"string"},"tavily_enabled":{"type":"boolean"},"tavily_search_endpoint":{"type":"string"},"tavily_timeout":{"type":"integer"},"searxng_url":{"type":"string","format":"uri"},"searxng_enabled":{"type":"boolean"},"vector_store_url":{"type":"string","format":"uri"},"sandbox_fusion_url":{"type":"string","format":"uri"},"sandbox_require_approval":{"type":"boolean"},"mcp_config_file":{"type":"string"}},"additionalProperties":false,"type":"object","required":["http_port","log_level","log_format","search_engine","serper_enabled","exa_enabled","exa_search_endpoint","exa_timeout","tavily_enabled","tavily_search_endpoint","tavily_timeout","searxng_url","searxng_enabled","vector_store_url","sandbox_fusion_url","sandbox_require_approval","mcp_config_file"]},"MediaAPIConfig":{"properties":{"http_port":{"type":"integer","maximum":65535,"minimum":1},"log_level":{"type":"string","enum":["debug","info","warn","error"]},"max_upload_bytes":{"type":"integer","minimum":1},"retention_days":{"type":"integer","minimum":1},"proxy_download":{"type":"boolean"},"remote_fetch_timeout":{"type":"integer"},"s3":{"$ref":"#/$defs/S3Config"}},"additionalProperties":false,"type":"object","required":["http_port","log_level","max_upload_bytes","retention_days","proxy_download","remote_fetch_timeout","s3"]},"MemoryCacheConfig":{"properties":{"max_size":{"type":"integer","minimum":1},"ttl":{"type":"integer"}},"additionalProperties":false,"type":"object","required":["max_size","ttl"]},"MemoryToolsConfig":{"properties":{"enabled":{"type":"boolean"},"http_port":{"type":"integer","maximum":65535,"minimum":1},"embedding":{"$ref":"#/$defs/EmbeddingConfig"}},"additionalProperties":false,"type":"object","required":["enabled","http_port","embedding"]},"MetaConfig":{"properties":{"version":{"type":"string"},"environment":{"type":"string"}},"additionalProperties":false,"type":"object","required":["version","environment"]},"MonitoringConfig":{"properties":{"otel":{"$ref":"#/$defs/OTELConfig"},"prometheus":{"$ref":"#/$defs/PrometheusConfig"},"grafana":{"$ref":"#/$defs/GrafanaConfig"},"jaeger":{"$ref":"#/$defs/JaegerConfig"}},"additionalProperties":false,"type":"object","required":["otel","prometheus","grafana","jaeger"]},"OTELConfig":{"properties":{"enabled":{"type":"boolean"},"tracing_enabled":{"type":"boolean"},"service_name":{"type":"string"},"service_version":{"type":"string"},"endpoint":{"type":"string","format":"uri"},"headers":{"additionalProperties":{"type":"string"},"type":"object"},"sampling_rate":{"type":"number","maximum":1,"minimum":0},"pii_level":{"type":"string","enum":["none","hashed","full"]},"metric_interval":{"type":"string"},"http_port":{"type":"integer","maximum":65535,"minimum":1},"grpc_port":{"type":"integer","maximum":65535,"minimum":1}},"additionalProperties":false,"type":"object","required":["enabled","tracing_enabled","service_name","service_version","endpoint","sampling_rate","pii_level","metric_interval","http_port","grpc_port"]},"PostgresConfig":{"properties":{"host":{"type":"string"},"port":{"type":"integer","maximum":65535,"minimum":1},"user":{"type":"string"},"database":{"type":"string"},"password":{"type":"string"},"ssl_mode":{"type":"string","enum":["disable","require","verify-ca","verify-full"]},"max_connections":{"type":"integer","maximum":1000,"minimum":1},"max_idle_conns":{"type":"integer","minimum":1},"max_open_conns":{"type":"integer","minimum":1},"conn_max_lifetime":{"type":"integer"}},"additionalProperties":false,"type":"object","required":["host","port","user","database","password","ssl_mode","max_connections","max_idle_conns","max_open_conns","conn_max_lifetime"]},"PrometheusConfig":{"properties":{"port":{"type":"integer","maximum":65535,"minimum":1}},"additionalProperties":false,"type":"object","required":["port"]},"PromptOrchestrationConfig":{"properties":{"enabled":{"type":"boolean"},"enable_memory":{"type":"boolean"},"enable_templates":{"type":"boolean"},"enable_tools":{"type":"boolean"}},"additionalProperties":false,"type":"object","required":["enabled","enable_memory","enable_templates","enable_tools"]},"RedisCacheConfig":{"properties":{"url":{"type":"string","format":"uri"},"key_prefix":{"type":"string"},"ttl":{"type":"integer"}},"additionalProperties":false,"type":"object","required":["url","key_prefix","ttl"]},"ResponseAPIConfig":{"properties":{"http_port":{"type":"integer","maximum":65535,"minimum":1},"log_level":{"type":"string","enum":["debug","info","warn","error"]},"llm_api_url":{"type":"string","format":"uri"},"mcp_tools_url":{"type":"string","format":"uri"},"max_tool_depth":{"type":"integer","maximum":20,"minimum":1},"tool_timeout":{"type":"integer"}},"additionalProperties":false,"type":"object","required":["http_port","log_level","llm_api_url","mcp_tools_url","max_tool_depth","tool_timeout"]},"RetryConfig":{"properties":{"enabled":{"type":"boolean"},"max_attempts":{"type":"integer","minimum":1},"initial_backoff":{"type":"integer"},"max_backoff":{"type":"integer"}},"additionalProperties":false,"type":"object","required":["enabled","max_attempts","initial_backoff","max_backoff"]},"S3Config":{"properties":{"endpoint":{"type":"string","format":"uri"},"public_endpoint":{"type":"string","format":"uri"},"region":{"type":"string"},"bucket":{"type":"string"},"access_key":{"type":"string"},"secret_key":{"type":"string"},"use_path_style":{"type":"boolean"},"presign_ttl":{"type":"integer"}},"additionalProperties":false,"type":"object","required":["endpoint","public_endpoint","region","bucket","use_path_style","presign_ttl"]},"ServicesConfig":{"properties":{"llm_api":{"$ref":"#/$defs/LLMAPIConfig"},"mcp_tools":{"$ref":"#/$defs/MCPToolsConfig"},"media_api":{"$ref":"#/$defs/MediaAPIConfig"},"response_api":{"$ref":"#/$defs/ResponseAPIConfig"},"memory_tools":{"$ref":"#/$defs/MemoryToolsConfig"}},"additionalProperties":false,"type":"object","required":["llm_api","mcp_tools","media_api","response_api","memory_tools"]},"VLLMConfig":{"properties":{"enabled":{"type":"boolean"},"port":{"type":"integer","maximum":65535,"minimum":1},"model":{"type":"string"},"served_name":{"type":"string"},"gpu_utilization":{"type":"number","maximum":1,"minimum":0},"internal_key":{"type":"string"},"hf_token":{"type":"string"}},"additionalProperties":false,"type":"object","required":["enabled","port","model","served_name","gpu_utilization"]}},"properties":{"meta":{"$ref":"#/$defs/MetaConfig"},"infrastructure":{"$ref":"#/$defs/InfrastructureConfig"},"services":{"$ref":"#/$defs/ServicesConfig"},"inference":{"$ref":"#/$defs/InferenceConfig"},"monitoring":{"$ref":"#/$defs/MonitoringConfig"}},"additionalProperties":false,"type":"object","required":["meta","infrastructure","services","inference","monitoring"],"title":"Jan Server Configuration","description":"Complete configuration schema for Jan Server infrastructure and services"}