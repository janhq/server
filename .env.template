# ============================================================================
# Jan Server Environment Configuration Template
# ============================================================================
# Copy this file to .env and customize for your environment
# 
# Quick Start:
#   make env-create              # Creates .env from this template
#   make env-switch ENV=hybrid   # Switch to hybrid development mode
#
# Available Environments:
#   - development  (all services in Docker)      - config/development.env
#   - hybrid       (native services + Docker)    - config/hybrid.env
#   - testing      (integration testing)         - config/testing.env
#   - production   (production deployment)       - config/production.env.example
#
# Documentation: See config/README.md for detailed environment guide
# ============================================================================

# ============================================================================
# REQUIRED: Secrets & API Keys
# ============================================================================
# You MUST set these values before running the services

# HuggingFace API token (required for model downloads)
# Get from: https://huggingface.co/settings/tokens
HF_TOKEN=your_huggingface_token_here

# Serper API key (required for MCP google_search tool)
# Get from: https://serper.dev
SERPER_API_KEY=your_serper_api_key_here

# Security secrets (CHANGE THESE in production!)
POSTGRES_PASSWORD=jan_password
KEYCLOAK_ADMIN_PASSWORD=admin
BACKEND_CLIENT_SECRET=backend-secret
MODEL_PROVIDER_SECRET=jan-model-provider-secret-2024
VLLM_INTERNAL_KEY=changeme

# ============================================================================
# PostgreSQL Database
# ============================================================================
POSTGRES_USER=jan_user
POSTGRES_DB=jan_llm_api
POSTGRES_PORT=5432
KEYCLOAK_DB_PORT=5433

# Database connection (varies by environment)
# Development:  postgres://jan_user:password@api-db:5432/jan_llm_api
# Hybrid:       postgres://jan_user:password@localhost:5432/jan_llm_api
DB_DSN=postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@api-db:5432/${POSTGRES_DB}?sslmode=disable
DATABASE_URL=postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@api-db:5432/${POSTGRES_DB}?sslmode=disable

# ============================================================================
# LLM API Service
# ============================================================================
HTTP_PORT=8080
LOG_LEVEL=info
LOG_FORMAT=json
AUTO_MIGRATE=true

# ============================================================================
# Authentication (Keycloak)
# ============================================================================
KEYCLOAK_ADMIN=admin
KEYCLOAK_HTTP_PORT=8085
KEYCLOAK_REALM=jan

# OAuth/OIDC Configuration (varies by environment)
# Development:  http://keycloak:8085
# Hybrid:       http://localhost:8085
KEYCLOAK_BASE_URL=http://keycloak:8085
JWKS_URL=http://keycloak:8085/realms/jan/protocol/openid-connect/certs
ISSUER=http://localhost:8085/realms/jan
AUDIENCE=jan-client
REFRESH_JWKS_INTERVAL=5m

# Guest provisioning
BACKEND_CLIENT_ID=backend
TARGET_CLIENT_ID=llm-api
GUEST_ROLE=guest

# ============================================================================
# API Gateway (Kong)
# ============================================================================
KONG_HTTP_PORT=8000

# ============================================================================
# Inference (vLLM)
# ============================================================================
VLLM_PORT=8001
VLLM_MODEL=Qwen/Qwen2.5-0.5B-Instruct
VLLM_SERVED_NAME=qwen2.5-0.5b-instruct
VLLM_GPU_UTIL=0.66

# Model provider configuration
JAN_PROVIDER_CONFIGS=true
JAN_PROVIDER_CONFIGS_FILE=config/providers.yml
JAN_PROVIDER_CONFIG_SET=default
# Legacy fallback (single provider) - leave disabled unless needed
# JAN_DEFAULT_NODE_SETUP=true
# JAN_DEFAULT_NODE_URL=http://vllm-jan-gpu:8001/v1
# JAN_DEFAULT_NODE_API_KEY=${VLLM_INTERNAL_KEY}

# ============================================================================
# MCP Tools Service
# ============================================================================
MCP_TOOLS_HTTP_PORT=8091

# Search engine configuration
SEARCH_ENGINE=serper                 # Options: serper, searxng
SERPER_DOMAIN_FILTER=                # Optional: domain filter for search results
SERPER_LOCATION_HINT=                # Optional: location hint for search
SERPER_OFFLINE_MODE=false            # Set true for offline testing

# MCP Provider URLs (vary by environment)
# Development:  http://searxng:8080
# Hybrid:       http://localhost:8086
SEARXNG_PORT=8086
SEARXNG_URL=http://searxng:8080
VECTOR_STORE_PORT=3015
VECTOR_STORE_URL=http://vector-store:3015
SANDBOXFUSION_PORT=3010
SANDBOXFUSION_URL=http://sandboxfusion:3010
SANDBOX_FUSION_REQUIRE_APPROVAL=true

# Browser automation & code execution
CODE_SANDBOX_ENABLED=true
CODE_SANDBOX_URL=http://code-sandbox-mcp:3000/mcp
PLAYWRIGHT_ENABLED=true
PLAYWRIGHT_URL=http://playwright-mcp:3000

# MCP debugging
MCP_PROVIDER_DEBUG=false

# ============================================================================
# Observability (OpenTelemetry, Prometheus, Jaeger, Grafana)
# ============================================================================
OTEL_ENABLED=false                   # Enable telemetry collection
OTEL_SERVICE_NAME=llm-api
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
OTEL_HTTP_PORT=4318
OTEL_GRPC_PORT=4317

# Monitoring stack ports
PROMETHEUS_PORT=9090
JAEGER_UI_PORT=16686
GRAFANA_PORT=3001
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin

# ============================================================================
# Environment-Specific Overrides
# ============================================================================
# The above values work for Docker development (all services in containers)
# 
# For other environments, use:
#   make env-switch ENV=hybrid      # Run services natively
#   make env-switch ENV=testing     # Integration testing
#
# Or manually copy from config/<environment>.env to .env
#
# See config/README.md for detailed environment configuration guide
# ============================================================================
